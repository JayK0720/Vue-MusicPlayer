{"remainingRequest":"/Users/jinkang/Desktop/Vue-MusicPlayer/node_modules/babel-loader/lib/index.js!/Users/jinkang/Desktop/Vue-MusicPlayer/node_modules/cache-loader/dist/cjs.js??ref--0-0!/Users/jinkang/Desktop/Vue-MusicPlayer/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/jinkang/Desktop/Vue-MusicPlayer/src/components/player/index.vue?vue&type=script&lang=js&","dependencies":[{"path":"/Users/jinkang/Desktop/Vue-MusicPlayer/src/components/player/index.vue","mtime":1572104389817},{"path":"/Users/jinkang/Desktop/Vue-MusicPlayer/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/jinkang/Desktop/Vue-MusicPlayer/node_modules/babel-loader/lib/index.js","mtime":499162500000},{"path":"/Users/jinkang/Desktop/Vue-MusicPlayer/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/jinkang/Desktop/Vue-MusicPlayer/node_modules/vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":["import \"core-js/modules/es7.object.get-own-property-descriptors\";\nimport \"core-js/modules/web.dom.iterable\";\nimport \"core-js/modules/es6.object.keys\";\nimport \"core-js/modules/es6.regexp.to-string\";\nimport \"core-js/modules/es6.array.find-index\";\nimport _defineProperty from \"/Users/jinkang/Desktop/Vue-MusicPlayer/node_modules/@babel/runtime-corejs2/helpers/esm/defineProperty\";\n\nfunction ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); if (enumerableOnly) symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; }); keys.push.apply(keys, symbols); } return keys; }\n\nfunction _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; if (i % 2) { ownKeys(source, true).forEach(function (key) { _defineProperty(target, key, source[key]); }); } else if (Object.getOwnPropertyDescriptors) { Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)); } else { ownKeys(source).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } } return target; }\n\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\nimport { mapGetters, mapMutations } from 'vuex';\nimport ProgressBar from '@/base/progress-bar';\nimport { playMode } from '@/common/js/config';\nimport { shuffle } from '@/common/js/util.js';\nexport default {\n  name: 'player',\n  data: function data() {\n    return {\n      flag: false,\n      currentTime: 0\n    };\n  },\n  components: {\n    ProgressBar: ProgressBar\n  },\n  computed: _objectSpread({}, mapGetters(['fullScreen', 'playList', 'currentSong', 'playing', 'currentIndex', 'mode', 'sequenceList']), {\n    cdClass: function cdClass() {\n      return this.playing ? 'play' : 'pause';\n    },\n    percent: function percent() {\n      return this.currentTime / this.currentSong.duration;\n    }\n  }),\n  methods: _objectSpread({}, mapMutations({\n    foldFullScreen: 'SET_FULL_SCREEN',\n    setPlayingState: 'SET_PLAYING',\n    setCurrentIndex: 'SET_CURRENT_INDEX',\n    setPlayMode: 'SET_MODE',\n    setPlayList: 'SET_PLAY_LIST'\n  }), {\n    handleFold: function handleFold() {\n      this.foldFullScreen(false);\n    },\n    handleTogglePlaying: function handleTogglePlaying() {\n      if (!this.flag) return; // playing 是getters里获取到的playing 状态, 点击播放按钮切换播放状态\n\n      this.setPlayingState(!this.playing);\n    },\n    handlePrev: function handlePrev() {\n      // 点击播放上一首\n      if (!this.flag) {\n        this.setPlayingState(false);\n        return;\n      }\n\n      var index = this.currentIndex - 1;\n\n      if (index === -1) {\n        index = this.playList.length - 1;\n      }\n\n      this.setCurrentIndex(index);\n      this.setPlayingState(true);\n      this.flag = false;\n    },\n    handleNext: function handleNext() {\n      if (!this.flag) {\n        this.setPlayingState(false);\n        return;\n      } // 点击播放下一首,当index改变的时候,currentSong就会修改\n\n\n      var index = this.currentIndex + 1;\n\n      if (index === this.playList.length) {\n        index = 0;\n      }\n\n      this.setCurrentIndex(index);\n      this.setPlayingState(true);\n      this.flag = false;\n    },\n    handleSliderEnd: function handleSliderEnd(percent) {\n      this.$refs.audio.currentTime = percent * this.currentSong.duration;\n\n      if (!this.playing) {\n        this.setPlayingState(true);\n      }\n    },\n    end: function end() {\n      if (this.mode === playMode.loop) {\n        this.loop();\n      } else {\n        this.handleNext();\n      }\n    },\n    loop: function loop() {\n      this.$refs.audio.currentTime = 0;\n      this.$refs.audio.play();\n    },\n\n    /*\n    在切换歌曲播放模式的时候,当前播放的歌曲在新的播放列表里的位置已经修改了，找到此时播放歌曲在新的播放列表里的位置,然后\n    修改index.\n    \n    todo:1\n    1. 点击歌曲的时候，设置了当前的播放列表 playList 以及 sequenceList, currentIndex, currentSong 来自playList[currentIndex]\n    2. 当切换播放模式为随机播放的时候, 修改了playList, 此时playList 和 循环列表播放的playList 不同\n    3. 切换播放模式后，再次点击播放列表里的歌曲时,比如点击的为第1首歌曲,由于playList已经修改，此时的currentSong 和 渲染的播放列表歌曲不同。\n    \n    \n    todo:2 此时切换歌曲的时候,由于播放歌曲列表已经为顺序播放，此时点击 上一曲 或者 下一曲的时候, 又变成了顺序播放\n    */\n    handleCheckPlayMode: function handleCheckPlayMode() {\n      var mode = (this.mode + 1) % 3;\n      this.setPlayMode(mode);\n      var list = [];\n\n      if (this.mode === playMode.random) {\n        /*\n        传入this.sequenceList后，返回的list 为打乱后的数组，此时this.sequenceList本身也被修改了.\n        当从随机模式切换为顺序播放或者单曲循环的时候,this.sequenceList还是为打乱后的列表而不是原始数据。\n        所以在shuffle函数内部,不能直接修改this.sequenceList\n        */\n        list = shuffle(this.sequenceList);\n      } else {\n        list = this.sequenceList;\n      }\n\n      this.resetIndex(list);\n      this.setPlayList(list);\n    },\n    resetIndex: function resetIndex(list) {\n      var _this = this;\n\n      var index = list.findIndex(function (item) {\n        return item.songid === _this.currentSong.songid;\n      });\n      this.setCurrentIndex(index);\n    },\n    ready: function ready() {\n      this.flag = true;\n    },\n    error: function error() {\n      this.flag = true;\n    },\n    timeupdate: function timeupdate(e) {\n      this.currentTime = e.target.currentTime;\n    },\n    format: function format(interval) {\n      var minute = Math.floor(interval / 60);\n      var second = this.padzero(interval % 60 | 0);\n      return \"\".concat(minute, \":\").concat(second);\n    },\n    padzero: function padzero(num) {\n      var length = num.toString().length;\n      return ('00' + num).substring(length);\n    }\n  }),\n  watch: {\n    currentSong: function currentSong(newSong, oldSong) {\n      var _this2 = this;\n\n      if (newSong.songid === oldSong.songid) return;\n      this.$nextTick(function () {\n        _this2.$refs.audio.play();\n\n        _this2.currentSong.getLyric();\n      });\n    },\n    playing: function playing(state) {\n      var _this3 = this;\n\n      this.$nextTick(function () {\n        var audio = _this3.$refs.audio;\n        state ? audio.play() : audio.pause();\n      });\n    }\n  }\n};",{"version":3,"sources":["index.vue"],"names":[],"mappings":"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","sourcesContent":["<template>\n\t<div class=\"player\" v-show='playList.length > 0'>\n\t\t<transition name='slide'>\n\t\t\t<div class=\"full-screen-player\" v-show='fullScreen'>\n\t\t\t\t<div class=\"player-background\">\n\t\t\t\t\t<img v-bind:src=\"currentSong.image\" alt=\"\" width='100%' height='100%'>\n\t\t\t\t</div>\n\t\t\t\t<div class=\"top\">\n\t\t\t\t\t<div class=\"arrow-down\" @touchstart.stop='handleFold'>\n\t\t\t\t\t\t<i class=\"iconfont\">&#xe721;</i>\n\t\t\t\t\t</div>\n\t\t\t\t\t<h1 class=\"song-name\">{{currentSong.songname}}</h1>\n\t\t\t\t\t<div class=\"menu\">\n\t\t\t\t\t\t<i class=\"iconfont\">&#xe610;</i>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t\t<div class=\"middle\">\n\t\t\t\t\t<div class=\"middle-left\">\n\t\t\t\t\t\t<div class=\"singer-name\">\n\t\t\t\t\t\t\t<p class='text'>{{currentSong.singer}}</p>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<div class=\"cd-wrapper\">\n\t\t\t\t\t\t\t<div class=\"cd\" :class='cdClass'>\n\t\t\t\t\t\t\t\t<img v-lazy=\"currentSong.image\" :alt=\"currentSong.songname\">\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class=\"middle-right\">\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t\t<div class=\"bottom\">\n\t\t\t\t\t<div class=\"progress-wrap\">\n\t\t\t\t\t\t<span class=\"current time\">{{format(currentTime)}}</span>\n\t\t\t\t\t\t<div class=\"progress-bar\">\n\t\t\t\t\t\t\t<ProgressBar :percent='percent' @percentChange='handleSliderEnd'/>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<span class=\"total time\">{{format(currentSong.duration)}}</span>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class=\"operator-wrap\">\n\t\t\t\t\t\t<div class=\"mode\" @click.prevent='handleCheckPlayMode'>\n\t\t\t\t\t\t\t<i class=\"iconfont\" v-if='mode===0'>&#xe674;</i>\n\t\t\t\t\t\t\t<i class=\"iconfont\" v-else-if='mode===1'>&#xe622;</i>\n\t\t\t\t\t\t\t<i class=\"iconfont\" v-else='mode===2'>&#xe612;</i>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<div class=\"prev\" @click='handlePrev'>\n\t\t\t\t\t\t\t<i class=\"iconfont\">&#xe602;</i>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<div class=\"play\" @click='handleTogglePlaying'>\n\t\t\t\t\t\t\t<template v-if='!playing'>\n\t\t\t\t\t\t\t\t<i class=\"iconfont\">&#xe652;</i>\n\t\t\t\t\t\t\t</template>\n\t\t\t\t\t\t\t<template v-else>\n\t\t\t\t\t\t\t\t<i class=\"iconfont\">&#xe603;</i>\n\t\t\t\t\t\t\t</template>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<div class=\"next\" @click='handleNext'>\n\t\t\t\t\t\t\t<i class=\"iconfont\">&#xe619;</i>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<div class=\"collect\">\n\t\t\t\t\t\t\t<i class=\"iconfont\">&#xe61a;</i>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t</transition>\n\t\t<!-- <Audio :url='currentSong.url' ref='audio'/> -->\n\t\t<audio \n\t\t\tv-bind:src=\"currentSong.url\" \n\t\t\tref='audio'\n\t\t\t@canplay='ready'\n\t\t\t@error='error'\n\t\t\t@timeupdate='timeupdate'\n\t\t\t@ended='end'\n\t\t></audio>\n\t</div>\n</template>\n\n<script>\n\timport {mapGetters,mapMutations} from 'vuex'\n\timport ProgressBar from '@/base/progress-bar'\n\timport {playMode} from '@/common/js/config'\n\timport {shuffle} from '@/common/js/util.js'\n\texport default{\n\t\tname:'player',\n\t\tdata() {\n\t\t\treturn {\n\t\t\t\tflag:false,\n\t\t\t\tcurrentTime:0\n\t\t\t}\n\t\t},\n\t\tcomponents:{ProgressBar},\n\t\tcomputed:{\n\t\t\t...mapGetters([\n\t\t\t\t\t'fullScreen',\n\t\t\t\t\t'playList',\n\t\t\t\t\t'currentSong',\n\t\t\t\t\t'playing',\n\t\t\t\t\t'currentIndex',\n\t\t\t\t\t'mode',\n\t\t\t\t\t'sequenceList'\n\t\t\t\t]),\n\t\t\tcdClass(){\n\t\t\t\treturn this.playing? 'play' : 'pause'\n\t\t\t},\n\t\t\tpercent(){\n\t\t\t\treturn this.currentTime / this.currentSong.duration;\n\t\t\t},\n\t\t},\n\t\tmethods:{\n\t\t\t...mapMutations({\n\t\t\t\tfoldFullScreen:'SET_FULL_SCREEN',\n\t\t\t\tsetPlayingState:'SET_PLAYING',\n\t\t\t\tsetCurrentIndex:'SET_CURRENT_INDEX',\n\t\t\t\tsetPlayMode:'SET_MODE',\n\t\t\t\tsetPlayList:'SET_PLAY_LIST'\n\t\t\t}),\n\t\t\thandleFold(){\n\t\t\t\tthis.foldFullScreen(false);\n\t\t\t},\n\t\t\thandleTogglePlaying(){\n\t\t\t\tif(!this.flag) return;\n\t\t\t\t// playing 是getters里获取到的playing 状态, 点击播放按钮切换播放状态\n\t\t\t\tthis.setPlayingState(!this.playing);\n\t\t\t},\n\t\t\thandlePrev(){\n\t\t\t\t// 点击播放上一首\n\t\t\t\tif(!this.flag){\n\t\t\t\t\tthis.setPlayingState(false);\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t\tlet index = this.currentIndex - 1;\n\t\t\t\tif(index === -1){\n\t\t\t\t\tindex = this.playList.length - 1;\n\t\t\t\t}\n\t\t\t\tthis.setCurrentIndex(index);\n\t\t\t\tthis.setPlayingState(true);\n\t\t\t\tthis.flag = false;\n\t\t\t},\n\t\t\thandleNext(){\n\t\t\t\tif(!this.flag) {\n\t\t\t\t\tthis.setPlayingState(false);\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t\t// 点击播放下一首,当index改变的时候,currentSong就会修改\n\t\t\t\tlet index = this.currentIndex + 1;\n\t\t\t\tif(index === this.playList.length){\n\t\t\t\t\tindex = 0;\n\t\t\t\t}\n\t\t\t\tthis.setCurrentIndex(index);\n\t\t\t\tthis.setPlayingState(true);\n\t\t\t\tthis.flag = false;\n\t\t\t},\n\t\t\thandleSliderEnd(percent){\n\t\t\t\tthis.$refs.audio.currentTime = percent * this.currentSong.duration;\n\t\t\t\tif(!this.playing){\n\t\t\t\t\tthis.setPlayingState(true);\n\t\t\t\t}\n\t\t\t},\n\t\t\tend(){\n\t\t\t\tif(this.mode === playMode.loop){\n\t\t\t\t\tthis.loop();\n\t\t\t\t}else{\n\t\t\t\t\tthis.handleNext();\n\t\t\t\t}\n\t\t\t},\n\t\t\tloop(){\n\t\t\t\tthis.$refs.audio.currentTime = 0;\n\t\t\t\tthis.$refs.audio.play();\n\t\t\t},\n\t\t\t/*\n\t\t\t在切换歌曲播放模式的时候,当前播放的歌曲在新的播放列表里的位置已经修改了，找到此时播放歌曲在新的播放列表里的位置,然后\n\t\t\t修改index.\n\t\t\t\n\t\t\ttodo:1\n\t\t\t1. 点击歌曲的时候，设置了当前的播放列表 playList 以及 sequenceList, currentIndex, currentSong 来自playList[currentIndex]\n\t\t\t2. 当切换播放模式为随机播放的时候, 修改了playList, 此时playList 和 循环列表播放的playList 不同\n\t\t\t3. 切换播放模式后，再次点击播放列表里的歌曲时,比如点击的为第1首歌曲,由于playList已经修改，此时的currentSong 和 渲染的播放列表歌曲不同。\n\t\t\t\n\t\t\t\n\t\t\ttodo:2 此时切换歌曲的时候,由于播放歌曲列表已经为顺序播放，此时点击 上一曲 或者 下一曲的时候, 又变成了顺序播放\n\t\t\t*/\n\t\t\thandleCheckPlayMode(){\n\t\t\t\tconst mode = (this.mode + 1)%3;\n\t\t\t\tthis.setPlayMode(mode);\n\t\t\t\tlet list = [];\n\t\t\t\tif(this.mode === playMode.random){\n\t\t\t\t\t/*\n\t\t\t\t\t传入this.sequenceList后，返回的list 为打乱后的数组，此时this.sequenceList本身也被修改了.\n\t\t\t\t\t当从随机模式切换为顺序播放或者单曲循环的时候,this.sequenceList还是为打乱后的列表而不是原始数据。\n\t\t\t\t\t所以在shuffle函数内部,不能直接修改this.sequenceList\n\t\t\t\t\t*/\n\t\t\t\t\tlist = shuffle(this.sequenceList);\n\t\t\t\t}else{\n\t\t\t\t\tlist = this.sequenceList;\n\t\t\t\t}\n\t\t\t\tthis.resetIndex(list);\n\t\t\t\tthis.setPlayList(list);\n\t\t\t},\n\t\t\tresetIndex(list){\n\t\t\t\tconst index = list.findIndex((item) => {\n\t\t\t\t\treturn item.songid === this.currentSong.songid;\n\t\t\t\t});\n\t\t\t\tthis.setCurrentIndex(index);\n\t\t\t},\n\t\t\tready(){\n\t\t\t\tthis.flag = true;\n\t\t\t},\n\t\t\terror(){\n\t\t\t\tthis.flag = true;\n\t\t\t},\n\t\t\ttimeupdate(e){\n\t\t\t\tthis.currentTime = e.target.currentTime;\n\t\t\t},\n\t\t\tformat(interval){\n\t\t\t\tlet minute = Math.floor(interval / 60);\n\t\t\t\tlet second = this.padzero(interval % 60 | 0 );\n\t\t\t\treturn `${minute}:${second}`;\n\t\t\t},\n\t\t\tpadzero(num){\n\t\t\t\tlet length = num.toString().length;\n\t\t\t\treturn ('00' + num).substring(length);\n\t\t\t}\n\t\t},\n\t\twatch:{\n\t\t\tcurrentSong(newSong,oldSong){\n\t\t\t\tif(newSong.songid === oldSong.songid) return;\n\t\t\t\tthis.$nextTick(() => {\n\t\t\t\t\tthis.$refs.audio.play();\n\t\t\t\t\tthis.currentSong.getLyric();\n\t\t\t\t}) \n\t\t\t},\n\t\t\tplaying(state){\n\t\t\t\tthis.$nextTick(() => {\n\t\t\t\t\tconst audio = this.$refs.audio;\n\t\t\t\t\tstate ? audio.play() : audio.pause();\n\t\t\t\t})\n\t\t\t}\n\t\t}\n\t}\n</script>\n\n<style lang='scss' scoped>\n\t@import '@/common/scss/mixin.scss';\n\t.full-screen-player{\n\t\tposition:fixed;\n\t\tleft:0;\n\t\tbottom:0;\n\t\ttop:0;\n\t\tright:0;\n\t\tz-index:200;\n\t\tbackground-color:#232323;\n\t\tcolor:#ffffff;\n\t\t.player-background{\n\t\t\tposition:absolute;\n\t\t\tleft:0;\n\t\t\ttop:0;\n\t\t\twidth:100%;\n\t\t\theight:100%;\n\t\t\topacity:0.4;\n\t\t\tz-index:-1;\n\t\t\tfilter:blur(25px);\n\t\t}\n\t\t.top{\n\t\t\tmargin-top:30px;\n\t\t\tdisplay:flex;\n\t\t\tpadding:0 16px;\n\t\t\theight:20px;\n\t\t\tjustify-content:space-between;\n\t\t\talign-items:center;\n\t\t\t.arrow-down{\n\t\t\t\ttransform:rotateZ(-90deg);\n\t\t\t}\n\t\t\t.arrow-down,.menu{\n\t\t\t\tflex:0 0 20px;\n\t\t\t\t.iconfont{\n\t\t\t\t\tfont-size:20px;\n\t\t\t\t}\n\t\t\t}\n\t\t\t.song-name{\n\t\t\t\ttext-align:center;\n\t\t\t}\n\t\t\t.song-name{\n\t\t\t\tflex:0 0 1;\n\t\t\t\theight:20px;\n\t\t\t\tline-height:20px;\n\t\t\t\tfont-size:18px;\n\t\t\t\t@include text-ellipsis;\n\t\t\t}\n\t\t}\n\t\t.middle{\n\t\t\tposition:fixed;\n\t\t\ttop:55px;\n\t\t\tbottom:135px;\n\t\t\twidth:100%;\n\t\t\t.singer-name{\n\t\t\t\tdisplay:flex;\n\t\t\t\tpadding:0 10px;\n\t\t\t\theight:44px;\n\t\t\t\tfont-size:14px;\n\t\t\t\tjustify-content:center;\n\t\t\t\talign-items:center;\n\t\t\t\tflex:1;\n\t\t\t\t.text{\n\t\t\t\t\tpadding:0 8px;\n\t\t\t\t\t@include text-ellipsis;\n\t\t\t\t}\n\t\t\t}\n\t\t\t.singer-name:before,.singer-name:after{\n\t\t\t\tcontent:'';\n\t\t\t\tdisplay:block;\n\t\t\t\tflex:0 0 18px;\n\t\t\t\twidth:18px;\n\t\t\t\theight:1px;\n\t\t\t\tbackground-color:#ffffff;\n\t\t\t}\n\t\t\t.middle-left{\n\t\t\t\tposition:relative;\n\t\t\t\theight:100%;\n\t\t\t\twidth:100%;\n\t\t\t}\n\t\t\t.cd-wrapper{\n\t\t\t\tposition:absolute;\n\t\t\t\ttop:50%;\n\t\t\t\tleft:50%;\n\t\t\t\ttransform:translate(-50%,-50%);\n\t\t\t\twidth:86%;\n\t\t\t\theight:0;\n\t\t\t\tpadding-top:86%;\n\t\t\t\tborder-radius:50%;\n\t\t\t\tborder:8px solid rgba(0,0,0,.3);\n\t\t\t\t.cd{\n\t\t\t\t\tposition:absolute;\n\t\t\t\t\tleft:0;\n\t\t\t\t\ttop:0;\n\t\t\t\t\twidth:100%;\n\t\t\t\t\theight:100%;\n\t\t\t\t\timg{\n\t\t\t\t\t\tdisplay:block;\n\t\t\t\t\t\twidth:100%;\n\t\t\t\t\t\theight:100%;\n\t\t\t\t\t\tborder-radius:50%;\n\t\t\t\t\t}\n\t\t\t\t\t&.play{\n\t\t\t\t\t\tanimation:rotate 20s linear infinite;\n\t\t\t\t\t\tanimation-play-state:run;\n\t\t\t\t\t}\n\t\t\t\t\t&.pause{\n\t\t\t\t\t\tanimation:rotate 20s linear infinite;\n\t\t\t\t\t\tanimation-play-state:paused;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\t.bottom{\n\t\t\tposition:absolute;\n\t\t\tbottom:30px;\n\t\t\twidth:100%;\n\t\t\t.progress-wrap{\n\t\t\t\tdisplay:flex;\n\t\t\t\tmargin:0 auto;\n\t\t\t\theight:45px;\n\t\t\t\twidth:90%;\n\t\t\t\tline-height:45px;\n\t\t\t\talign-items:center;\n\t\t\t\t.time{\n\t\t\t\t\tflex:0 0 36px;\n\t\t\t\t\twidth:36px;\n\t\t\t\t\tcolor:#fff;\n\t\t\t\t\tfont-size:12px;\n\t\t\t\t}\n\t\t\t\t.current{\n\t\t\t\t\ttext-align:left;\n\t\t\t\t}\n\t\t\t\t.total{\n\t\t\t\t\ttext-align:right;\n\t\t\t\t}\n\t\t\t\t.progress-bar{\n\t\t\t\t\tflex:1;\n\t\t\t\t\theight:2px;\n\t\t\t\t}\n\t\t\t}\n\t\t\t.operator-wrap{\n\t\t\t\tdisplay:flex;\n\t\t\t\theight:54px;\n\t\t\t\tcolor:#fff;\n\t\t\t\talign-items:center;\n\t\t\t\tjustify-content:space-around;\n\t\t\t\t.mode,.collect{\n\t\t\t\t\t.iconfont{\n\t\t\t\t\t\tfont-size:24px;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\t.play{\n\t\t\t\t\t.iconfont{\n\t\t\t\t\t\tfont-size:40px;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\t.prev,.next{\n\t\t\t\t\t.iconfont{\n\t\t\t\t\t\tfont-size:30px;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\t.slide-enter-active,.slide-leave-active{\n\t\ttransition:all .3s;\n\t}\n\t.slide-enter,.slide-leave-to{\n\t\ttransform:translate3d(0,100%,0);\n\t}\n\t/*图片旋转动画*/\n\t@keyframes rotate{\n\t\t0%{\n\t\t\ttransform:rotateZ(0deg);\n\t\t}\n\t\t100%{\n\t\t\ttransform:rotateZ(360deg);\n\t\t}\n\t}\n</style>\n"],"sourceRoot":"src/components/player"}]}