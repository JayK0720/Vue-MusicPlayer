{"remainingRequest":"/Users/jinkang/Desktop/Vue-MusicPlayer/node_modules/babel-loader/lib/index.js!/Users/jinkang/Desktop/Vue-MusicPlayer/node_modules/cache-loader/dist/cjs.js??ref--0-0!/Users/jinkang/Desktop/Vue-MusicPlayer/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/jinkang/Desktop/Vue-MusicPlayer/src/base/listview/index.vue?vue&type=script&lang=js&","dependencies":[{"path":"/Users/jinkang/Desktop/Vue-MusicPlayer/src/base/listview/index.vue","mtime":1573050225264},{"path":"/Users/jinkang/Desktop/Vue-MusicPlayer/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/jinkang/Desktop/Vue-MusicPlayer/node_modules/babel-loader/lib/index.js","mtime":499162500000},{"path":"/Users/jinkang/Desktop/Vue-MusicPlayer/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/jinkang/Desktop/Vue-MusicPlayer/node_modules/vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":["//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\nvar INDEX_HEIGHT = 20;\nvar TITLE_HEIGHT = 42;\nimport Scroll from '@/base/scroll';\nimport Loading from '@/base/loading';\nexport default {\n  name: 'listview',\n  data: function data() {\n    return {\n      listenScroll: true,\n      probeType: 3,\n      currentIndex: 0,\n      scrollHeight: [],\n      scrollY: -1,\n      diffY: 0\n    };\n  },\n  components: {\n    Scroll: Scroll,\n    Loading: Loading\n  },\n  props: {\n    data: {\n      type: Array,\n      default: function _default() {\n        return [];\n      }\n    }\n  },\n  computed: {\n    listIndex: function listIndex() {\n      return this.data.map(function (item) {\n        return item.title.substring(0, 1);\n      });\n    },\n    fixedTitle: function fixedTitle() {\n      if (this.scrollY > 0) {\n        return '';\n      }\n\n      if (this.scrollY < 0) {\n        return this.data.length ? this.data[this.currentIndex].title : '';\n      }\n    }\n  },\n  created: function created() {\n    this.touch = {}, this.listHeight = [];\n  },\n  watch: {\n    data: function data() {\n      var _this = this;\n\n      this.$nextTick(function () {\n        _this._calcHeight();\n      });\n    },\n    diffY: function diffY(value) {\n      var fixedTop = value > 0 && value < TITLE_HEIGHT ? TITLE_HEIGHT - value : 0;\n      if (this.fixedTop === value) return;\n      this.$refs.fixedTitle.style.transform = \"translate3d(0,\".concat(-fixedTop, \"px,0)\");\n    }\n  },\n  methods: {\n    handleTouchIndex: function handleTouchIndex(event, index) {\n      this.touch.y1 = event.touches[0].pageY; // 第一次按下鼠标时的y值\n\n      this.touch.startIndex = index;\n\n      this._scrollToIndex(index);\n\n      this.currentIndex = index;\n    },\n    handleTouchMove: function handleTouchMove(event) {\n      this.touch.y2 = event.touches[0].pageY; // 在手指拖动时获取到的y轴的偏移量，两者的差值为拖动的距离\n\n      var delta = Math.round((this.touch.y2 - this.touch.y1) / INDEX_HEIGHT);\n      var index = this.touch.startIndex + delta;\n      this.currentIndex = index;\n\n      this._scrollToIndex(index);\n    },\n    handleScroll: function handleScroll(_ref) {\n      var y = _ref.y;\n      this.scrollY = y; // 当前滚动的高度\n\n      if (y >= 0) {\n        this.currentIndex = 0;\n        return;\n      }\n\n      var listHeight = this.listHeight;\n\n      for (var i = 0; i < listHeight.length - 1; i++) {\n        var y1 = listHeight[i],\n            y2 = listHeight[i + 1];\n\n        if (-y >= y1 && -y < y2) {\n          this.currentIndex = i;\n          this.diffY = y2 + y;\n          return;\n        }\n      }\n\n      if (-y > listHeight[listHeight.length - 1]) {\n        this.currentHeight = listHeight.length - 1;\n        return;\n      }\n    },\n    handleSelectSinger: function handleSelectSinger(props) {\n      this.$emit('select', props);\n    },\n    _scrollToIndex: function _scrollToIndex(index) {\n      var groupListItem = this.$refs.groupListItem[index];\n      this.$refs.scroll.scrollToElement(groupListItem, 0);\n    },\n    _calcHeight: function _calcHeight() {\n      var height = 0,\n          listHeight = [],\n          list = this.$refs.groupListItem;\n      listHeight.push(height);\n\n      for (var i = 0, len = list.length; i < len; i++) {\n        height += list[i].clientHeight;\n        listHeight.push(height);\n      }\n\n      this.listHeight = listHeight;\n    }\n  }\n};",{"version":3,"sources":["index.vue"],"names":[],"mappings":"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","sourcesContent":["<template>\n\t<Scroll \n\t\t:data='data' \n\t\tref='scroll'\n\t\t:listen-scroll='listenScroll'\n\t\t:probe-type='probeType'\n\t\t@scroll='handleScroll'\n\t\tclass='scroll-wrapper'\n\t>\n\t\t<ul class='group-list'>\n\t\t\t<li v-for='(group,index) in data' :key='index' ref='groupListItem'>\n\t\t\t\t<h2 class='group-title'>{{group.title}}</h2>\n\t\t\t\t<ul class='singer-list'>\n\t\t\t\t\t<li \n\t\t\t\t\t\tv-for='(item,index) in group.items' \n\t\t\t\t\t\t:key='index'\n\t\t\t\t\t\tclass='singer-item'\n\t\t\t\t\t\t@click='handleSelectSinger(item)'\n\t\t\t\t\t>\n\t\t\t\t\t\t<img v-bind:src=\"item.avatar\" v-bind:alt=\"item.name\" width='60' height='60' class='avatar'>\n\t\t\t\t\t\t<span class='name'>{{item.name}}</span>\n\t\t\t\t\t</li>\n\t\t\t\t</ul>\n\t\t\t</li>\n\t\t</ul>\n\t\t<div class=\"singer-index\" @touchmove.stop.prevent='handleTouchMove'>\n\t\t\t<ul class='index-list'>\n\t\t\t\t<li \n\t\t\t\t\tv-for='(item,index) in listIndex' \n\t\t\t\t\t:key='index'\n\t\t\t\t\t@touchstart='handleTouchIndex($event,index)'\n\t\t\t\t\tv-bind:class='{current:currentIndex === index}'\n\t\t\t\t\tclass='index-item'\n\t\t\t\t>{{item}}</li>\n\t\t\t</ul>\n\t\t</div>\n\t\t<div class=\"list-fixed\" v-show='fixedTitle' ref='fixedTitle'>\n\t\t\t<h2 class=\"fixed-title\">{{fixedTitle}}</h2>\n\t\t</div>\n\t\t<Loading v-show='!data.length'/>\n\t</Scroll>\n</template>\n\n<script>\n\tconst INDEX_HEIGHT = 20;\n\tconst TITLE_HEIGHT = 42;\n\timport Scroll from '@/base/scroll'\n\timport Loading from '@/base/loading'\n\texport default{\n\t\tname:'listview',\n\t\tdata() {\n\t\t\treturn{\n\t\t\t\tlistenScroll:true,\n\t\t\t\tprobeType:3,\n\t\t\t\tcurrentIndex:0,\n\t\t\t\tscrollHeight:[],\n\t\t\t\tscrollY:-1,\n\t\t\t\tdiffY:0\n\t\t\t}\n\t\t},\n\t\tcomponents:{Scroll,Loading},\n\t\tprops:{\n\t\t\tdata:{\n\t\t\t\ttype:Array,\n\t\t\t\tdefault:function() {\n\t\t\t\t\treturn []\n\t\t\t\t}\n\t\t\t}\n\t\t},\n\t\tcomputed:{\n\t\t\tlistIndex(){\n\t\t\t\treturn this.data.map((item) => {\n\t\t\t\t\treturn item.title.substring(0,1);\n\t\t\t\t}) \n\t\t\t},\n\t\t\tfixedTitle(){\n\t\t\t\tif(this.scrollY > 0){\n\t\t\t\t\treturn '';\n\t\t\t\t}\n\t\t\t\tif(this.scrollY < 0){\n\t\t\t\t\treturn this.data.length ? this.data[this.currentIndex].title : '';\n\t\t\t\t}\n\t\t\t}\n\t\t},\n\t\tcreated(){\n\t\t\tthis.touch = {},\n\t\t\tthis.listHeight = []\n\t\t},\n\t\twatch:{\n\t\t\tdata(){\n\t\t\t\tthis.$nextTick(() => {\n\t\t\t\t\tthis._calcHeight();\n\t\t\t\t})\n\t\t\t},\n\t\t\tdiffY(value){\n\t\t\t\tlet fixedTop = (value > 0 && value < TITLE_HEIGHT) ? TITLE_HEIGHT - value : 0;\n\t\t\t\tif(this.fixedTop === value) return;\n\t\t\t\tthis.$refs.fixedTitle.style.transform = `translate3d(0,${-fixedTop}px,0)`;\n\t\t\t}\n\t\t},\n\t\tmethods:{\n\t\t\thandleTouchIndex(event,index){\n\t\t\t\tthis.touch.y1 = event.touches[0].pageY;\t// 第一次按下鼠标时的y值\n\t\t\t\tthis.touch.startIndex = index;\n\t\t\t\tthis._scrollToIndex(index);\n\t\t\t\tthis.currentIndex = index;\n\t\t\t},\n\t\t\thandleTouchMove(event){\n\t\t\t\tthis.touch.y2 = event.touches[0].pageY;\t// 在手指拖动时获取到的y轴的偏移量，两者的差值为拖动的距离\n\t\t\t\tconst delta = Math.round( (this.touch.y2 - this.touch.y1) / INDEX_HEIGHT);\n\t\t\t\tlet index = this.touch.startIndex + delta;\n\t\t\t\tthis.currentIndex = index;\n\t\t\t\tthis._scrollToIndex(index);\n\t\t\t},\n\t\t\thandleScroll({y}){\n\t\t\t\tthis.scrollY = y;\t// 当前滚动的高度\n\t\t\t\tif(y >= 0) {\n\t\t\t\t\tthis.currentIndex = 0; \n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t\tconst listHeight = this.listHeight;\n\t\t\t\tfor(let i = 0; i < listHeight.length - 1; i++){\n\t\t\t\t\tlet y1 = listHeight[i], y2 = listHeight[i+1];\n\t\t\t\t\tif( (-y >= y1) && (-y < y2) ){\n\t\t\t\t\t\tthis.currentIndex = i;\n\t\t\t\t\t\tthis.diffY = y2 + y;\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tif(-y > listHeight[listHeight.length-1]){\n\t\t\t\t\tthis.currentHeight = listHeight.length - 1;\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t},\n\t\t\thandleSelectSinger(props){\n\t\t\t\tthis.$emit('select',props);\n\t\t\t},\n\t\t\t_scrollToIndex(index){\n\t\t\t\tconst groupListItem = this.$refs.groupListItem[index];\n\t\t\t\tthis.$refs.scroll.scrollToElement(groupListItem,0);\n\t\t\t},\n\t\t\t_calcHeight(){\n\t\t\t\tlet height = 0,listHeight = [],list = this.$refs.groupListItem;\n\t\t\t\tlistHeight.push(height);\n\t\t\t\tfor(let i = 0,len = list.length; i < len; i++){\n\t\t\t\t\theight += list[i].clientHeight;\n\t\t\t\t\tlistHeight.push(height);\n\t\t\t\t}\n\t\t\t\tthis.listHeight = listHeight;\n\t\t\t}\n\t\t}\n\t}\n</script>\n\n<style lang='scss' scoped>\n\t.scroll-wrapper{\n\t\theight:100%;\n\t\toverflow:hidden;\n\t}\n\t.group-title,.fixed-title{\n\t\tpadding-left:16px;\n\t\theight:42px;\n\t\tline-height:42px;\n\t\tbackground-color:#f9f9f9;\n\t\tcolor:#898989;\n\t\tfont-size:12px;\n\t}\n\t.singer-list{\n\t\tpadding:0 16px;\n\t}\n\t.singer-item{\n\t\tdisplay:flex;\n\t\talign-items:center;\n\t\theight:60px;\n\t\tmargin-bottom:12px;\n\t\t&:last-child{\n\t\t\tmargin-bottom:0;\n\t\t}\n\t\t.avatar{\n\t\t\tmargin-right:10px;\n\t\t\twidth:60px;\n\t\t\theight:60px;\n\t\t\tdisplay:block;\n\t\t\tborder-radius:50%;\n\t\t}\n\t\t.name{\n\t\t\tfont-size:14px;\n\t\t\tcolor:#1a1a1a;\n\t\t}\n\t}\n\t.singer-index{\n\t\tposition:absolute;\n\t\ttop:50%;\n\t\ttransform:translateY(-50%);\n\t\tright:16px;\n\t\twidth:24px;\n\t\ttext-align:center;\n\t\tbackground-color:#fff;\n\t\tborder-radius:12px;\n\t\tz-index:100;\n\t\tli{\n\t\t\tline-height:20px;\n\t\t\tfont-size:10px;\n\t\t\tcolor:#8c8c8c;\n\t\t\t&.current{\n\t\t\t\tcolor:#22d59c;\n\t\t\t}\n\t\t}\n\t}\n\t.list-fixed{\n\t\tposition:absolute;\n\t\tleft:0;\n\t\ttop:0;\n\t\twidth:100%;\n\t\theight:43px;\n\t}\n</style>\n"],"sourceRoot":"src/base/listview"}]}